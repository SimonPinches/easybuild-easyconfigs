easyblock = 'CMakeMake'

name = 'PaStiX'
version = '6.0.0'

homepage = 'http://pastix.gforge.inria.fr/'
description = """PaStiX (Parallel Sparse matriX package) is a scientific library that provides a high performance
 parallel solver for very large sparse linear systems based on direct methods."""

toolchain = {'name': 'intel', 'version': '2018a'}
toolchainopts = {'pic': True}

source_urls = ['https://gforge.inria.fr/frs/download.php/file/37244/']
sources = [SOURCELOWER_TAR_GZ]

patches = ['PaStiX-6.0.0_intel.patch']

checksums = [
    '1dc37475964d7baa0df30c5909bfdf459dd0db66b866f9d9f566ab6fd7e12d7f',  # pastix-6.0.0.tar.gz
    'ad8905c49663e787bc101730dc38b601ef50ef2b022f2f8a0fc2e640c859796e',  # PaStiX-6.0.0_intel.patch
]

builddependencies = [
    ('CMake', '3.9.1')
]

dependencies = [
    ('hwloc', '1.11.8'),
    ('SCOTCH', '6.0.4'),
]

configopts = '-DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=ON -DPASTIX_INT64=OFF '
configopts += '-DPASTIX_WITH_MPI=ON -DBUILD_DOCMENTATION=ON'

separate_build_dir = True

sanity_check_paths = {
    'files': ['bin/pastix_env.sh', 'lib/libpastix.so', 'lib/pkgconfig/pastix.pc', 'include/pastix.h'],
    'dirs': ['bin', 'examples', 'include', 'lib'],
}

moduleclass = 'math'
